# 30강. 뷰 작성과 삭제 

뷰는 테이블과 같은 부류의 데이터베이스 ``객체`` 중 하나이다. 앞의 5장에서는 *서브쿼리* 에 관해 배웠다. 서브쿼리는 FROM 구에서도 사용할 수 있었는데, 
여기서 ```FROM 구에 사용된 서브쿼리에 이름을 붙이고 데이터베이스 객체화하여 쓰기 쉽게 한 것```을 **뷰** 라고 한다. 

## 1. 뷰 
데이터베이스 객체란 테이블이나 인덱스 등 데이터베이스 안에 정의하는 모든 것을 말한다 뷰 역시 데이터베이스 객체 중 하나이다. 반면 SELECT 명령은 객체가 아니다. 
SELECT 명령에 이름을 지정할 수도 없고 데이터베이스에 등록되지도 않기 때문이다. <br> <br>

이처럼 본래 데이터베이스 객체로 등록할 수 없는 SELECT 명령을, 객체로서 이름을 붙여 관리할 수 있도록 한 것이 **뷰**이다. SELECT 명령은 실행했을 때 테이블에 저장된 데이터를 
결괏값으로 반환한다. 따라서 뷰를 참조하면 그에 정의된 SELECT 명령의 실행결과를 테이블처럼 사용할 수 있다. <br> <br>

FROM 구에는 서브쿼리를 사용할 수 있다. 예를 들면 다음과 같은 SELECT 명령이다. 
```mysql
SELECT * FROM (SELECT * FROM sample54) sq;
```

앞의 예에서 서브쿼리 부분을 '뷰 객체'로 만들면 다음과 같은 SELECT 명령이 된다. 
```mysql
SELECT * FROM sample_view_67;
```
sample_view_67은 뷰의 이름이다. 뷰를 정의할 때는 이름과 SELECT 명령을 지정한다. 뷰를 만든 후에는 SELECT 명령에서 뷰의 이름을 지정하면 참조할 수 있다. <br>

앞의 예제에서는 서브쿼리가 단순한 SELECT 명령으로 되어 있지만, 실제 업무에서 WHERE 구로 조건을 지정하거나 GROUP BY 구로 집계하는 등 좀더 복잡한 명령으로 
이루어지는 경우가 많고, 이런 경우 서브쿼리를 뷰로 대체하여 SELECT 명령을 더 간략하게 표현할 수 있다. 또한 자주 사용하거나 복잡한 SELECT 명령을 뷰로 만들어 편리하게 사용할 수 있는 것이다. 

### - 가상 테이블 
뷰는 테이블처럼 취급할 수 있지만 '실체가 존재하지 않는다'라는 의미로 '**가상 테이블**'이라 불리기도 한다. SELECT 명령으로 이루어지는 뷰는 테이블처럼 데이터를 쓰거나 지울 수 있는 저장공간을 
가지지 않는다. 그래서 테이블처럼 취급할 수는 있지만, ```SELECT 명령에서만 사용```하는 것을 권장한다. INSERT나 UPDATE, DELETE 명령에서도 조건이 맞으면 가능하지만 사용에 주의할 필요가 있다. 

## 2. 뷰 작성과 삭제 
뷰는 데이터베이스 객체이기 때문에 DDL로 작성하거나 삭제한다. 작성할 때는 ```CREATE VIEW```를, 삭제할 때는 ```DROP VIEW```를 사용한다. 

### - 뷰의 작성 

*SYNTAX* **CREATE VIEW** 
> CREATE VIEW 뷰명 AS SELECT 명령 

CREATE VIEW 다음에 뷰의 이름을 지정하고, AS로 SELECT 명령을 지정한다. CREATE VIEW의 AS 키워드는 별명을 붙일 때 사용하는 AS와는 달리 생략할 수 없다. 

### 예제 | 뷰 작성하기 
```mysql
CREATE VIEW sample_view_67 AS SELECT * FROM sample54;

SELECT * FROM sample_view_67;
```

CREATE VIEW로 뷰를 작성한 뒤 SELECT 명령의 FROM 구에 지정해 사용할 수 있다. 또한 뷰는 필요에 따라 열을 지정할 수도 있는데, 이 경우에는 이름 뒤에 괄호로 묶어 열을 나열한다. 

*SYNTAX* CREATE VIEW에서 열 지정하기 
> CREATE VIEW 본명 (열명1, 열명2, ... ) AS SELECT 명령 

뷰의 열 지정을 생략한 경우에는 SELECT 명령의 SELECT 구에서 지정하는 열 정보가 수집되어 자동적으로 뷰의 열로 지정된다. 반대로 열을 지정한 경우에는 SELECT 명령의 SELECT 구에 
지정한 열보다 우선된다. 다만 SELECT 명령의 SELECT 구와 같은 수의 열을 일일이 지정해야 하므로 SELECT 명령의 모든 열을 사용할 경우에는 열을 지정하지 않는 편이 낫다. 
또한 열 이외에는 정의할 수 없으며, 테이블의 열을 정의할 때처럼 자료형이나 제약도 지정할 수 없다. 

### 예제 | 열을 지정해 뷰 작성하기 

```mysql
CREATE VIEW sample_view_672(n, v, v2) AS 
    SELECT no, a, a*2 FROM sample54;

SELECT * FROM sample_view_672 WHERE n = 1;
```

### - 뷰 삭제 

뷰를 삭제할 경우에는 DROP VIEW를 사용한다. 일단 뷰를 삭제하면 더 이상 뷰를 참조하여 사용할 수 없다. 

*SYNTAX* **DROP VIEW**
> DROP VIEW 뷰명 

### 예제 | 뷰 삭제하기 

```mysql
DROP VIEW sample_view_67;
```

## 3. 뷰의 약점 

뷰는 데이터베이스 객체로서 저장장치에 저장되지만 테이블과 달리 대량의 저장공간을 필요로 하지 않는다. 데이터베이스에 저장되는 것은 SELECT 명령뿐이기 때문이다. 

